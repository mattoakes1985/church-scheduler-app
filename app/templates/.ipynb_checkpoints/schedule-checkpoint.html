{% extends "layout.html" %}

{% block title %}Schedule Volunteers{% endblock %}

{% block content %}
  <h1 class="text-2xl font-bold mb-6">Schedule Volunteers Into Events</h1>

  <form method="GET">

    <!-- Year Dropdown -->
    <div class="mb-4">
      <label for="year-select" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Select Year</label>
      <select name="year" id="year-select"
              class="w-full md:w-1/2 p-2 border rounded text-black bg-white
               dark:text-white dark:bg-gray-800"
              hx-get="/schedule/months"
              hx-target="#month-wrapper"
              hx-include="#year-select"
              hx-trigger="change">
        <option value="">-- All Years --</option>
        {% for y in years %}
          <option value="{{ y[0] }}" {% if y[0] == selected_year %}selected{% endif %}>{{ y[0] }}</option>
        {% endfor %}
      </select>
    </div>

    <!-- Month Dropdown (HTMX will replace this) -->
    <div id="month-wrapper" class="mb-4">
      {% if months %}
        <label for="month-select" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Select Month</label>
        <select name="month" id="month-select"
                class="w-full md:w-1/2 p-2 border rounded text-black bg-white
               dark:text-white dark:bg-gray-800"
                hx-get="/schedule/events"
                hx-target="#event-select-wrapper"
                hx-include="#year-select, #month-select"
                hx-trigger="change">
          <option value="">-- All Months --</option>
          {% for m in months %}
            <option value="{{ m[0] }}" {% if m[0] == selected_month %}selected{% endif %}>{{ m[1] }}</option>
          {% endfor %}
        </select>
      {% endif %}
    </div>

    <!-- Event Dropdown (HTMX will replace this) -->
    <div id="event-select-wrapper" class="mb-6">
      {% if events %}
        <label for="event-select" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Select Event</label>
        <select name="event_id" id="event-select"
                class="w-full md:w-1/2 p-2 border rounded text-black bg-white
               dark:text-white dark:bg-gray-800"">
          <option value="">-- Choose an Event --</option>
          {% for event in events %}
            <option value="{{ event.id }}" {% if event.id == selected_event_id %}selected{% endif %}>
              {{ event.name }} ({{ event.date.strftime('%Y-%m-%d') }})
            </option>
          {% endfor %}
        </select>
      {% endif %}
    </div>

    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
      Load Roles
    </button>
  </form>

{% endblock %}