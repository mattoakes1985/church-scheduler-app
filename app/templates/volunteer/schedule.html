{% extends "layout.html" %}
{% block content %}
<div class="p-4">
  <h1 class="text-xl font-semibold mb-4">Master Schedule</h1>

  <form method="GET" class="mb-6">
  <div class="flex flex-wrap gap-4 items-end">

    <div>
      <label for="team_id" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Team</label>
      <select name="team_id" id="team_id"
              class="block w-44 p-2 rounded-md border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-black dark:text-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none"
              onchange="this.form.submit()">
        <option value="">Choose a team</option>
        {% for team in teams %}
          <option value="{{ team.id }}" {% if selected_team and selected_team.id == team.id %}selected{% endif %}>
            {{ team.name }}
          </option>
        {% endfor %}
      </select>
    </div>

  </div>
</form>


  {% if selected_team %}
    <table class="w-full table-auto text-sm border border-gray-300 dark:border-gray-700">
      <thead>
        <tr class="bg-gray-200 dark:bg-gray-700">
          <th class="p-2 text-left">Role \ Event</th>
          {% for e in events %}
            <th class="p-2 text-center">{{ e.date.strftime('%b %d') }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for role in roles %}
          <tr>
            <td class="p-2 font-medium">{{ role.name }}</td>
            {% for e in events %}
              <td class="p-2 text-center">
                {% set v = assignment_matrix.get((e.id, role.id)) %}
                {{ v.name if v else "" }}
              </td>
            {% endfor %}
          </tr>
        {% endfor %}
        <tr class="bg-gray-50 dark:bg-gray-800">
          <td class="p-2 font-semibold">Songs</td>
          {% for e in events %}
            <td class="p-2 italic text-gray-500">[Not yet added]</td>
          {% endfor %}
        </tr>
      </tbody>
    </table>
  {% endif %}
</div>
{% endblock %}
